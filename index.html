<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Photography Portfolio</title>

  <!-- Google Font & Lucide Icons -->
  <link href="https://fonts.googleapis.com/css2?family=Source+Sans+Pro:wght@300;400;600&display=swap" rel="stylesheet">
  <script src="https://unpkg.com/lucide@latest"></script>

  <!-- EXIF Reader -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/exif-js/2.3.0/exif.min.js"></script>

  <style>
    :root {
      --bg-color: white;
      --text-color: black;
      --footer-color: gray;
    }

    body.dark {
      --bg-color: #242424;
      --text-color: white;
      --footer-color: #bbb;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html, body {
      scroll-behavior: smooth;
      overflow-x: hidden;
    }

    body {
      font-family: 'Source Sans Pro', sans-serif;
      background-color: var(--bg-color);
      color: var(--text-color);
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 2rem 1rem;
      animation: smoke-reveal 2s ease forwards;
      opacity: 0;
      transition: background-color 0.3s ease, color 0.3s ease;
    }

    @keyframes smoke-reveal {
      0% {
        opacity: 0;
        filter: blur(20px);
        transform: translateY(50px);
      }
      100% {
        opacity: 1;
        filter: blur(0);
        transform: translateY(0);
      }
    }

    .header {
      text-align: center;
      font-size: 1.5rem;
      margin-bottom: 6rem;
    }

    .toggle-button {
      position: fixed;
      top: 20px;
      right: 20px;
      background: none;
      border: none;
      cursor: pointer;
      font-size: 1.5rem;
      color: var(--text-color);
      z-index: 999;
    }

    .gallery {
      column-count: 3;
      column-gap: 1rem;
      width: 100%;
      max-width: 1800px;
    }

    .gallery-item {
      break-inside: avoid;
      margin-bottom: 1rem;
      transform: translateY(30px);
      opacity: 0;
      transition: transform 0.6s ease, opacity 0.6s ease;
    }

    .gallery-item.visible {
      transform: translateY(0);
      opacity: 1;
    }

    .gallery-item img {
      width: 100%;
      height: auto;
      display: block;
      object-fit: cover;
      border-radius: 0;
      transition: transform 0.3s ease;
      cursor: pointer;
    }

    .gallery-item img:hover {
      transform: scale(1.025);
    }

    footer {
      margin-top: 7rem;
      font-size: 0.9rem;
      color: var(--footer-color);
      text-align: center;
    }

    /* Lightbox styling */
    .lightbox {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: rgba(0, 0, 0, 0.95);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s ease;
      overflow: hidden;
    }

    .lightbox.show {
      opacity: 1;
      pointer-events: auto;
    }

    .lightbox img {
      max-width: 90vw;
      max-height: 80vh;
      transition: transform 0.3s ease;
      cursor: zoom-in;
    }

    .lightbox img.zoomed {
      cursor: move;
    }

    .lightbox-controls {
      position: absolute;
      top: 1rem;
      right: 1rem;
      z-index: 10000;
    }

    .lightbox-close {
      font-size: 2rem;
      color: white;
      cursor: pointer;
    }

    #metadata {
      position: absolute;
      bottom: 2rem;
      color: #ccc;
      font-size: 0.9rem;
      text-align: center;
    }

    /* Thumbnail carousel */
    .thumb-carousel {
      position: absolute;
      bottom: 0.5rem;
      width: 100%;
      display: flex;
      justify-content: center;
      gap: 0.3rem;
      overflow-x: auto;
      padding: 0.5rem;
    }

    .thumb-carousel img {
      height: 60px;
      cursor: pointer;
      opacity: 0.6;
      transition: transform 0.3s, opacity 0.3s;
    }

    .thumb-carousel img.current {
      transform: scale(1.05);
      opacity: 1;
      border: 2px solid white;
    }

    @media (max-width: 1000px) {
      .gallery {
        column-count: 2;
      }
    }

    @media (max-width: 600px) {
      .gallery {
        column-count: 1;
      }

      .header {
        font-size: 1.2rem;
        margin-bottom: 4rem;
      }

      .toggle-button {
        font-size: 1.3rem;
      }
    }
  </style>
</head>
<body>
  <!-- Dark Mode Toggle -->
  <button class="toggle-button" id="toggleDarkMode" aria-label="Toggle Dark Mode">
    <i data-lucide="moon"></i>
  </button>

  <!-- Header -->
  <div class="header">
    Lance's Portfolio
  </div>

  <!-- Masonry Grid Gallery -->
  <div class="gallery" id="gallery"></div>

  <!-- Lightbox -->
  <div class="lightbox" id="lightbox">
    <img id="lightboxImage" src="" alt="Large View" />
    <div class="lightbox-controls">
      <div id="lightboxClose" class="lightbox-close">×</div>
    </div>
    <div id="metadata"></div>
    <div class="thumb-carousel" id="thumbCarousel"></div>
  </div>

  <!-- Footer -->
  <footer>
    Thank you :)
  </footer>

  <!-- Part 2: JavaScript will be in next message -->

<script>
  lucide.createIcons();

  // --- Dark Mode Toggle ---
  const toggleBtn = document.getElementById("toggleDarkMode");
  const icon = toggleBtn.querySelector("i");

  toggleBtn.addEventListener("click", () => {
    document.body.classList.toggle("dark");
    icon.dataset.lucide = document.body.classList.contains("dark") ? "sun" : "moon";
    lucide.createIcons();
  });

  // Disable scroll restoration
  if ('scrollRestoration' in history) {
    history.scrollRestoration = 'manual';
  }

  // --- Scroll Reveal Animation ---
  const observer = new IntersectionObserver(entries => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        entry.target.classList.add("visible");
      }
    });
  }, { threshold: 0.1 });

  // --- Load Flickr Images into Custom Grid ---
  const imageUrls = [
    // Add your Flickr direct JPG links here (grabbed from "Download" → "View all sizes" on each photo)
    "https://live.staticflickr.com/65535/54585944978_fb3dfc678a_b.jpg",
    "https://live.staticflickr.com/65535/54586065229_4fd6c0b9f4_b.jpg",
    "https://live.staticflickr.com/65535/54585503936_2cd2f9c13a_b.jpg",
    "https://live.staticflickr.com/65535/54585600384_14cf2a4b2c_b.jpg",
    "https://live.staticflickr.com/65535/54584603632_a5a981be1b_b.jpg"
    // ➕ Add more Flickr JPG URLs here — no need to number!
  ];

  const gallery = document.getElementById("gallery");
  const lightbox = document.getElementById("lightbox");
  const lightboxImage = document.getElementById("lightboxImage");
  const metadata = document.getElementById("metadata");
  const thumbCarousel = document.getElementById("thumbCarousel");
  const lightboxClose = document.getElementById("lightboxClose");

  let currentIndex = 0;
  let isZoomed = false;

  function showLightbox(index) {
    currentIndex = index;
    updateLightbox();
    document.body.style.overflow = "hidden";
    lightbox.classList.add("show");
  }

  function hideLightbox() {
    lightbox.classList.remove("show");
    document.body.style.overflow = "";
    lightboxImage.classList.remove("zoomed");
    lightboxImage.style.transform = "none";
    metadata.textContent = "";
    isZoomed = false;
  }

  function updateLightbox() {
    const url = imageUrls[currentIndex];
    lightboxImage.src = url;
    extractEXIF(url);
    updateThumbnails();
  }

  function updateThumbnails() {
    thumbCarousel.innerHTML = "";

    const start = Math.max(0, currentIndex - 3);
    const end = Math.min(imageUrls.length - 1, currentIndex + 3);

    for (let i = start; i <= end; i++) {
      const thumb = document.createElement("img");
      thumb.src = imageUrls[i];
      if (i === currentIndex) thumb.classList.add("current");
      thumb.addEventListener("click", () => showLightbox(i));
      thumbCarousel.appendChild(thumb);
    }
  }

  function extractEXIF(url) {
    metadata.textContent = "";
    const img = new Image();
    img.crossOrigin = "anonymous";
    img.onload = () => {
      EXIF.getData(img, function() {
        const iso = EXIF.getTag(this, "ISOSpeedRatings");
        const aperture = EXIF.getTag(this, "FNumber");
        const shutter = EXIF.getTag(this, "ExposureTime");
        const parts = [];
        if (shutter) parts.push(`Shutter: 1/${Math.round(1 / shutter)}s`);
        if (aperture) parts.push(`Aperture: ƒ/${aperture}`);
        if (iso) parts.push(`ISO: ${iso}`);
        metadata.textContent = parts.join("   ");
      });
    };
    img.src = url;
  }

  function createImageElement(url, index) {
    const item = document.createElement("div");
    item.className = "gallery-item";

    const img = document.createElement("img");
    img.src = url;
    img.loading = "lazy";
    img.alt = `Photo ${index + 1}`;
    img.addEventListener("click", () => showLightbox(index));

    item.appendChild(img);
    gallery.appendChild(item);
    observer.observe(item);
  }

  imageUrls.forEach((url, i) => createImageElement(url, i));

  // Lightbox close
  lightboxClose.addEventListener("click", hideLightbox);
  lightbox.addEventListener("click", (e) => {
    if (e.target === lightbox) hideLightbox();
  });

  // Arrow navigation
  document.addEventListener("keydown", (e) => {
    if (!lightbox.classList.contains("show")) return;
    if (e.key === "ArrowRight" && currentIndex < imageUrls.length - 1) {
      currentIndex++;
      updateLightbox();
    } else if (e.key === "ArrowLeft" && currentIndex > 0) {
      currentIndex--;
      updateLightbox();
    } else if (e.key === "Escape") {
      hideLightbox();
    }
  });

  // Swipe (touch) navigation
  let touchStartX = 0;
  lightbox.addEventListener("touchstart", (e) => {
    touchStartX = e.touches[0].clientX;
  });

  lightbox.addEventListener("touchend", (e) => {
    const dx = e.changedTouches[0].clientX - touchStartX;
    if (dx > 50 && currentIndex > 0) {
      currentIndex--;
      updateLightbox();
    } else if (dx < -50 && currentIndex < imageUrls.length - 1) {
      currentIndex++;
      updateLightbox();
    }
  });

  // Zoom + pan
  let originX = 0;
  let originY = 0;
  lightboxImage.addEventListener("click", (e) => {
    if (!isZoomed) {
      lightboxImage.classList.add("zoomed");
      lightboxImage.style.transform = "scale(2)";
      originX = e.clientX;
      originY = e.clientY;
      isZoomed = true;
    } else {
      lightboxImage.classList.remove("zoomed");
      lightboxImage.style.transform = "scale(1)";
      lightboxImage.style.left = "unset";
      lightboxImage.style.top = "unset";
      isZoomed = false;
    }
  });

  let isDragging = false;
  let startX, startY;
  lightboxImage.addEventListener("mousedown", (e) => {
    if (!isZoomed) return;
    isDragging = true;
    startX = e.clientX;
    startY = e.clientY;
    e.preventDefault();
  });

  window.addEventListener("mousemove", (e) => {
    if (!isDragging || !isZoomed) return;
    const dx = e.clientX - startX;
    const dy = e.clientY - startY;
    lightboxImage.style.transform = `scale(2) translate(${dx}px, ${dy}px)`;
  });

  window.addEventListener("mouseup", () => {
    isDragging = false;
  });
</script>
</body>
</html>
